function getTechnicalDataById(dataSheetId, id, kwh_annui, profilo_consumi) {
  var dataSheet = SpreadsheetApp.openById(dataSheetId);
  var sheet = dataSheet.getSheetById('1lOUBcCT3j38sBtuXBJ2MuQqKttvCmecq_JDkQWG3n7M');
  var data = sheet.getDataRange().getValues();
  var header = data[0];
  var idColumnIndex = header.indexOf("id");

  if (idColumnIndex === -1) {
    throw new Error('Colonna "id" non trovata.');
  }

  for (var i = 1; i < data.length; i++) {
    if (data[i][idColumnIndex] == id) {
      return data[i];
    }
  }
  throw new Error('ID non trovato nel file dei dati tecnici.');
}

function addTechnicalData(destinationSheet, data) {
  var lastRow = destinationSheet.getLastRow() + 1;
  destinationSheet.getRange(lastRow, 1, 1, data.length).setValues([data]);
}
